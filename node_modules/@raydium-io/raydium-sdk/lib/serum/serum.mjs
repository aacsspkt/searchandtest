import{PublicKey as Z}from"@solana/web3.js";import{PublicKey as he}from"@solana/web3.js";import{PublicKey as j,SystemProgram as q}from"@solana/web3.js";import{PublicKey as F}from"@solana/web3.js";var x="1.1.0-beta.1";import"@colors/colors";var L=!1,_=!1,d={debug:1,default:2,info:2,warning:3,error:4,off:5},w={},h;function V(){try{let o=[];if(["NFD","NFC","NFKD","NFKC"].forEach(e=>{try{if("test".normalize(e)!=="test")throw new Error("bad normalize")}catch{o.push(e)}}),o.length)throw new Error("missing "+o.join(", "));if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken implementation")}catch(o){if(o instanceof Error)return o.message}return""}var A=V(),U=(a=>(a.DEBUG="DEBUG",a.INFO="INFO",a.WARNING="WARNING",a.ERROR="ERROR",a.OFF="OFF",a))(U||{}),I=(c=>(c.UNKNOWN_ERROR="UNKNOWN_ERROR",c.NOT_IMPLEMENTED="NOT_IMPLEMENTED",c.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",c.NETWORK_ERROR="NETWORK_ERROR",c.RPC_ERROR="RPC_ERROR",c.TIMEOUT="TIMEOUT",c.BUFFER_OVERRUN="BUFFER_OVERRUN",c.NUMERIC_FAULT="NUMERIC_FAULT",c.MISSING_NEW="MISSING_NEW",c.INVALID_ARGUMENT="INVALID_ARGUMENT",c.MISSING_ARGUMENT="MISSING_ARGUMENT",c.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",c.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",c))(I||{}),N="0123456789abcdef";function O(o,e=!1){let t=o;try{if(o instanceof Uint8Array){let r="";for(let n=0;n<o.length;n++)r+=N[o[n]>>4],r+=N[o[n]&15];t=`Uint8Array(0x${r})`}else if(o instanceof F)t=`PublicKey(${o.toBase58()})`;else if(o instanceof Object&&!e){let r={};Object.entries(o).forEach(([n,a])=>{r[n]=O(a,!0)}),t=JSON.stringify(r)}else e||(t=JSON.stringify(o))}catch{t=JSON.stringify(o.toString())}return t}var s=class{constructor(e){this.version=x;this.moduleName=e}_log(e,t){let r=e.toLowerCase();d[r]==null&&this.throwArgumentError("invalid log level name","logLevel",e),!((w[this.moduleName]||d.default)>d[r])&&console.log(...t)}debug(...e){this._log(s.levels.DEBUG,["[DEBUG]".blue,...e])}info(...e){this._log(s.levels.INFO,["[INFO]".green,...e])}warn(...e){this._log(s.levels.WARNING,["[WARN]".yellow,...e])}makeError(e,t,r){if(_)return this.makeError("censored error",t,{});t||(t=s.errors.UNKNOWN_ERROR),r||(r={});let n=[];Object.entries(r).forEach(([g,b])=>{n.push(`${g}=${O(b)})`)}),n.push(`code=${t}`),n.push(`module=${this.moduleName}`),n.push(`version=${this.version}`);let a=e;n.length&&(e+=" ("+n.join(", ")+")");let l=new Error(e);return l.reason=a,l.code=t,Object.entries(r).forEach(([g,b])=>{l[g]=b}),l}throwError(e,t,r){throw this.makeError(e,t,r)}throwArgumentError(e,t,r){return this.throwError(e,s.errors.INVALID_ARGUMENT,{argument:t,value:r})}assert(e,t,r,n){e||this.throwError(t,r,n)}assertArgument(e,t,r,n){e||this.throwArgumentError(t,r,n)}checkNormalize(e){e==null&&(e="platform missing String.prototype.normalize"),A&&this.throwError("platform missing String.prototype.normalize",s.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:A})}checkSafeUint53(e,t){typeof e=="number"&&(t==null&&(t="value not safe"),(e<0||e>=9007199254740991)&&this.throwError(t,s.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:e}),e%1&&this.throwError(t,s.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:e}))}checkArgumentCount(e,t,r){r?r=": "+r:r="",e<t&&this.throwError("missing argument"+r,s.errors.MISSING_ARGUMENT,{count:e,expectedCount:t}),e>t&&this.throwError("too many arguments"+r,s.errors.UNEXPECTED_ARGUMENT,{count:e,expectedCount:t})}checkNew(e,t){(e===Object||e==null)&&this.throwError("missing new",s.errors.MISSING_NEW,{name:t.name})}checkAbstract(e,t){e===t?this.throwError("cannot instantiate abstract class "+JSON.stringify(t.name)+" directly; use a sub-class",s.errors.UNSUPPORTED_OPERATION,{name:e.name,operation:"new"}):(e===Object||e==null)&&this.throwError("missing new",s.errors.MISSING_NEW,{name:t.name})}static globalLogger(){return h||(h=new s(x)),h}static setCensorship(e,t){if(!e&&t&&this.globalLogger().throwError("cannot permanently disable censorship",s.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),L){if(!e)return;this.globalLogger().throwError("error censorship permanent",s.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}_=!!e,L=!!t}static setLogLevel(e,t){let r=d[t.toLowerCase()];if(r==null){s.globalLogger().warn("invalid log level - "+t);return}w[e]=r}static from(e){return new s(e)}},y=s;y.errors=I,y.levels=U;import{ASSOCIATED_TOKEN_PROGRAM_ID as le,TOKEN_PROGRAM_ID as me}from"@solana/spl-token";import{SYSVAR_CLOCK_PUBKEY as Pe,SYSVAR_RENT_PUBKEY as ge}from"@solana/web3.js";var ue=y.from("common/pubkey"),ce=q.programId,pe=new j("Memo1UhkJRfHyvLMcVucJwxXeuD728EqVDDwQDxFMNo");import{PublicKey as Re}from"@solana/web3.js";import _e from"bn.js";import{PACKET_DATA_SIZE as De,PublicKey as Ke,Transaction as ve}from"@solana/web3.js";var je=y.from("common/web3");import{PublicKey as $}from"@solana/web3.js";var B="9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin",z=new $(B),M={[B]:3},D={3:z};import{PublicKey as Q}from"@solana/web3.js";import k,{isBN as or}from"bn.js";import{bits as nt,BitStructure as ot,blob as J,Blob as st,cstr as at,f32 as it,f32be as ut,f64 as ct,f64be as pt,greedy as yt,Layout as Y,ns64 as ft,ns64be as lt,nu64 as mt,nu64be as dt,offset as Pt,s16 as gt,s16be as bt,s24 as xt,s24be as ht,s32 as Tt,s32be as St,s40 as Et,s40be as Rt,s48 as Lt,s48be as _t,s8 as wt,seq as At,struct as Nt,Structure as X,u16 as Ut,u16be as It,u24 as Ot,u24be as Bt,u32 as Mt,u32be as Dt,u40 as Kt,u40be as kt,u48 as Ct,u48be as vt,u8 as Gt,UInt as Ft,union as Vt,Union as jt,unionLayoutDiscriminator as qt,utf8 as Wt}from"@solana/buffer-layout";var T=Y,K=X;var m=J;var S=class extends T{constructor(t,r,n){super(t,n);this.blob=m(t),this.signed=r}decode(t,r=0){let n=new k(this.blob.decode(t,r),10,"le");return this.signed?n.fromTwos(this.span*8).clone():n}encode(t,r,n=0){return typeof t=="number"&&(t=new k(t)),this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),r,n)}};function p(o){return new S(8,!1,o)}var E=class extends T{constructor(t,r,n,a){super(t.span,a);this.layout=t,this.decoder=r,this.encoder=n}decode(t,r){return this.decoder(this.layout.decode(t,r))}encode(t,r,n){return this.layout.encode(this.encoder(t),r,n)}getSpan(t,r){return this.layout.getSpan(t,r)}};function f(o){return new E(m(32),e=>new Q(e),e=>e.toBuffer(),o)}var R=class extends K{decode(e,t){return super.decode(e,t)}};function C(o,e,t){return new R(o,e,t)}var H=C([m(5),m(8),f("ownAddress"),p("vaultSignerNonce"),f("baseMint"),f("quoteMint"),f("baseVault"),p("baseDepositsTotal"),p("baseFeesAccrued"),f("quoteVault"),p("quoteDepositsTotal"),p("quoteFeesAccrued"),p("quoteDustThreshold"),f("requestQueue"),f("eventQueue"),f("bids"),f("asks"),p("baseLotSize"),p("quoteLotSize"),p("feeRateBps"),p("referrerRebatesAccrued"),m(7)]),v={3:H};var P=y.from("Serum"),G=class{static getProgramId(e){let t=D[e];return P.assertArgument(!!t,"invalid version","version",e),t}static getVersion(e){let t=e.toBase58(),r=M[t];return P.assertArgument(!!r,"invalid program id","programId",t),r}static getStateLayout(e){let t=v[e];return P.assertArgument(!!t,"invalid version","version",e),t}static getLayouts(e){return{state:this.getStateLayout(e)}}static async getAssociatedAuthority({programId:e,marketId:t}){let r=[t.toBuffer()],n=0,a;for(;n<100;){try{let l=r.concat(Buffer.from([n]),Buffer.alloc(7));a=await Z.createProgramAddress(l,e)}catch(l){if(l instanceof TypeError)throw l;n++;continue}return{publicKey:a,nonce:n}}return P.throwArgumentError("unable to find a viable program address nonce","params",{programId:e,marketId:t})}};export{G as Market};
//# sourceMappingURL=serum.mjs.map