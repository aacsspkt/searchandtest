var Z=Object.create;var N=Object.defineProperty,rr=Object.defineProperties,tr=Object.getOwnPropertyDescriptor,er=Object.getOwnPropertyDescriptors,nr=Object.getOwnPropertyNames,M=Object.getOwnPropertySymbols,or=Object.getPrototypeOf,D=Object.prototype.hasOwnProperty,ir=Object.prototype.propertyIsEnumerable;var F=(e,r,t)=>r in e?N(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,P=(e,r)=>{for(var t in r||(r={}))D.call(r,t)&&F(e,t,r[t]);if(M)for(var t of M(r))ir.call(r,t)&&F(e,t,r[t]);return e},K=(e,r)=>rr(e,er(r));var sr=(e,r)=>{for(var t in r)N(e,t,{get:r[t],enumerable:!0})},G=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of nr(r))!D.call(e,o)&&o!==t&&N(e,o,{get:()=>r[o],enumerable:!(n=tr(r,o))||n.enumerable});return e};var cr=(e,r,t)=>(t=e!=null?Z(or(e)):{},G(r||!e||!e.__esModule?N(t,"default",{value:e,enumerable:!0}):t,e)),ar=e=>G(N({},"__esModule",{value:!0}),e);var Ir={};sr(Ir,{ASSOCIATED_TOKEN_PROGRAM_ID:()=>b.ASSOCIATED_TOKEN_PROGRAM_ID,AccountMeta:()=>pr,AccountMetaReadonly:()=>gr,ErrorCode:()=>x,LogLevel:()=>U,Logger:()=>u,MEMO_PROGRAM_ID:()=>fr,SYSTEM_PROGRAM_ID:()=>ur,SYSVAR_CLOCK_PUBKEY:()=>A.SYSVAR_CLOCK_PUBKEY,SYSVAR_RENT_PUBKEY:()=>A.SYSVAR_RENT_PUBKEY,TOKEN_PROGRAM_ID:()=>b.TOKEN_PROGRAM_ID,chunkArray:()=>_,findProgramAddress:()=>mr,forecastTransactionSize:()=>X,getMultipleAccountsInfo:()=>q,getMultipleAccountsInfoWithCustomFlags:()=>dr,inspectAll:()=>Er,inspectBN:()=>V,inspectPublicKey:()=>z,intersection:()=>Rr,jsonInfo2PoolKeys:()=>hr,parseSimulateLogToJson:()=>Ar,parseSimulateValue:()=>Or,poolKeys2JsonInfo:()=>yr,simulateMultipleInstruction:()=>br,uniq:()=>Tr,validateAndParsePublicKey:()=>d,xor:()=>Nr});module.exports=ar(Ir);var J=require("@solana/web3.js");var R=require("@solana/web3.js");var W=require("@solana/web3.js");var w="1.1.0-beta.1";var Ur=require("@colors/colors"),C=!1,B=!1,T={debug:1,default:2,info:2,warning:3,error:4,off:5},k={},S;function lr(){try{let e=[];if(["NFD","NFC","NFKD","NFKC"].forEach(r=>{try{if("test".normalize(r)!=="test")throw new Error("bad normalize")}catch{e.push(r)}}),e.length)throw new Error("missing "+e.join(", "));if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken implementation")}catch(e){if(e instanceof Error)return e.message}return""}var v=lr(),U=(i=>(i.DEBUG="DEBUG",i.INFO="INFO",i.WARNING="WARNING",i.ERROR="ERROR",i.OFF="OFF",i))(U||{}),x=(a=>(a.UNKNOWN_ERROR="UNKNOWN_ERROR",a.NOT_IMPLEMENTED="NOT_IMPLEMENTED",a.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",a.NETWORK_ERROR="NETWORK_ERROR",a.RPC_ERROR="RPC_ERROR",a.TIMEOUT="TIMEOUT",a.BUFFER_OVERRUN="BUFFER_OVERRUN",a.NUMERIC_FAULT="NUMERIC_FAULT",a.MISSING_NEW="MISSING_NEW",a.INVALID_ARGUMENT="INVALID_ARGUMENT",a.MISSING_ARGUMENT="MISSING_ARGUMENT",a.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",a.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",a))(x||{}),L="0123456789abcdef";function j(e,r=!1){let t=e;try{if(e instanceof Uint8Array){let n="";for(let o=0;o<e.length;o++)n+=L[e[o]>>4],n+=L[e[o]&15];t=`Uint8Array(0x${n})`}else if(e instanceof W.PublicKey)t=`PublicKey(${e.toBase58()})`;else if(e instanceof Object&&!r){let n={};Object.entries(e).forEach(([o,i])=>{n[o]=j(i,!0)}),t=JSON.stringify(n)}else r||(t=JSON.stringify(e))}catch{t=JSON.stringify(e.toString())}return t}var s=class{constructor(r){this.version=w;this.moduleName=r}_log(r,t){let n=r.toLowerCase();T[n]==null&&this.throwArgumentError("invalid log level name","logLevel",r),!((k[this.moduleName]||T.default)>T[n])&&console.log(...t)}debug(...r){this._log(s.levels.DEBUG,["[DEBUG]".blue,...r])}info(...r){this._log(s.levels.INFO,["[INFO]".green,...r])}warn(...r){this._log(s.levels.WARNING,["[WARN]".yellow,...r])}makeError(r,t,n){if(B)return this.makeError("censored error",t,{});t||(t=s.errors.UNKNOWN_ERROR),n||(n={});let o=[];Object.entries(n).forEach(([l,c])=>{o.push(`${l}=${j(c)})`)}),o.push(`code=${t}`),o.push(`module=${this.moduleName}`),o.push(`version=${this.version}`);let i=r;o.length&&(r+=" ("+o.join(", ")+")");let f=new Error(r);return f.reason=i,f.code=t,Object.entries(n).forEach(([l,c])=>{f[l]=c}),f}throwError(r,t,n){throw this.makeError(r,t,n)}throwArgumentError(r,t,n){return this.throwError(r,s.errors.INVALID_ARGUMENT,{argument:t,value:n})}assert(r,t,n,o){r||this.throwError(t,n,o)}assertArgument(r,t,n,o){r||this.throwArgumentError(t,n,o)}checkNormalize(r){r==null&&(r="platform missing String.prototype.normalize"),v&&this.throwError("platform missing String.prototype.normalize",s.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:v})}checkSafeUint53(r,t){typeof r=="number"&&(t==null&&(t="value not safe"),(r<0||r>=9007199254740991)&&this.throwError(t,s.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:r}),r%1&&this.throwError(t,s.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:r}))}checkArgumentCount(r,t,n){n?n=": "+n:n="",r<t&&this.throwError("missing argument"+n,s.errors.MISSING_ARGUMENT,{count:r,expectedCount:t}),r>t&&this.throwError("too many arguments"+n,s.errors.UNEXPECTED_ARGUMENT,{count:r,expectedCount:t})}checkNew(r,t){(r===Object||r==null)&&this.throwError("missing new",s.errors.MISSING_NEW,{name:t.name})}checkAbstract(r,t){r===t?this.throwError("cannot instantiate abstract class "+JSON.stringify(t.name)+" directly; use a sub-class",s.errors.UNSUPPORTED_OPERATION,{name:r.name,operation:"new"}):(r===Object||r==null)&&this.throwError("missing new",s.errors.MISSING_NEW,{name:t.name})}static globalLogger(){return S||(S=new s(w)),S}static setCensorship(r,t){if(!r&&t&&this.globalLogger().throwError("cannot permanently disable censorship",s.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),C){if(!r)return;this.globalLogger().throwError("error censorship permanent",s.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}B=!!r,C=!!t}static setLogLevel(r,t){let n=T[t.toLowerCase()];if(n==null){s.globalLogger().warn("invalid log level - "+t);return}k[r]=n}static from(r){return new s(r)}},u=s;u.errors=x,u.levels=U;var b=require("@solana/spl-token"),A=require("@solana/web3.js"),$=u.from("common/pubkey"),ur=R.SystemProgram.programId,fr=new R.PublicKey("Memo1UhkJRfHyvLMcVucJwxXeuD728EqVDDwQDxFMNo");function d(e){if(e instanceof R.PublicKey)return e;if(typeof e=="string")try{return new R.PublicKey(e)}catch{return $.throwArgumentError("invalid public key","publicKey",e)}return $.throwArgumentError("invalid public key","publicKey",e)}async function mr(e,r){let[t,n]=await R.PublicKey.findProgramAddress(e,r);return{publicKey:t,nonce:n}}function pr(e,r){return{pubkey:e,isWritable:!0,isSigner:r}}function gr(e,r){return{pubkey:e,isWritable:!1,isSigner:r}}function hr(e){return Object.entries(e).reduce((r,[t,n])=>(typeof n=="string"?r[t]=d(n):n instanceof Array?r[t]=n.map(o=>d(o)):r[t]=n,r),{})}function yr(e){return Object.entries(e).reduce((r,[t,n])=>(n instanceof J.PublicKey?r[t]=n.toBase58():n instanceof Array?r[t]=n.map(o=>o.toBase58()):r[t]=n,r),{})}var O=require("@solana/web3.js"),I=cr(require("bn.js"));function z(){if(typeof Symbol<"u"&&typeof Symbol.for=="function")try{O.PublicKey.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return`<PublicKey: ${this.toString()}>`}}catch{O.PublicKey.prototype.inspect=function(){return`<PublicKey: ${this.toString()}>`}}else O.PublicKey.prototype.inspect=function(){return`<PublicKey: ${this.toString()}>`}}function V(){if(typeof Symbol<"u"&&typeof Symbol.for=="function")try{I.default.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return`<${this.red?"BN-R":"BN"}: ${this.toString()}>`}}catch{I.default.prototype.inspect=function(){return`<${this.red?"BN-R":"BN"}: ${this.toString()}>`}}else I.default.prototype.inspect=function(){return`<${this.red?"BN-R":"BN"}: ${this.toString()}>`}}function Er(){z(),V()}function _(e,r=1,t=[]){let n=[...e];if(r<=0)return t;for(;n.length;)t.push(n.splice(0,r));return t}function Rr(e,...r){return e.filter(t=>r.every(n=>n.includes(t)))}function Nr(e,...r){return e.filter(t=>r.every(n=>!n.includes(t)))}function Tr(e){return[...new Set(e)]}var g=require("@solana/web3.js");var m=u.from("common/web3");async function q(e,r,t){let{batchRequest:n,commitment:o}=P({batchRequest:!1},t),i=_(r,100),f=new Array(i.length).fill([]);if(n){let l=i.map(h=>{let E=e._buildArgs([h.map(y=>y.toBase58())],o,"base64");return{methodName:"getMultipleAccounts",args:E}});f=(await e._rpcBatchRequest(l)).map(h=>h.error?m.throwError("failed to get info for multiple accounts",u.errors.RPC_ERROR,{message:h.error.message}):h.result.value.map(E=>{if(E){let{data:y,executable:Y,lamports:a,owner:H,rentEpoch:Q}=E;return y.length!==2&&y[1]!=="base64"?m.throwError("info must be base64 encoded",u.errors.RPC_ERROR):{data:Buffer.from(y[0],"base64"),executable:Y,lamports:a,owner:new g.PublicKey(H),rentEpoch:Q}}else return null}))}else try{f=await Promise.all(i.map(l=>e.getMultipleAccountsInfo(l,o)))}catch(l){if(l instanceof Error)return m.throwError("failed to get info for multiple accounts",u.errors.RPC_ERROR,{message:l.message})}return f.flat()}async function dr(e,r,t){let n=await q(e,r.map(o=>o.pubkey),t);return r.map((o,i)=>K(P({},o),{accountInfo:n[i]}))}function X(e,r){if(e.length<1)return m.throwArgumentError("no instructions provided","instructions",e);if(r.length<1)return m.throwArgumentError("no signers provided","signers",r);let t=new g.Transaction({recentBlockhash:"11111111111111111111111111111111",feePayer:r[0]});t.add(...e);let n=t.compileMessage().serialize();return r.length+r.length*64+n.length}async function br(e,r,t){let n=new g.PublicKey("RaydiumSimuLateTransaction11111111111111111"),o=[],i=new g.Transaction({feePayer:n});for(let c of r)X([...i.instructions,c],[n])>g.PACKET_DATA_SIZE&&(o.push(i),i=new g.Transaction({feePayer:n})),i.add(c);i.instructions.length>0&&o.push(i);let f=[];try{f=await Promise.all(o.map(c=>e.simulateTransaction(c)))}catch(c){if(c instanceof Error)return m.throwError("failed to simulate for instructions",u.errors.RPC_ERROR,{message:c.message})}let l=[];for(let c of f){let{value:h}=c;if(m.debug("simulate result:",c),h.logs){let E=h.logs.filter(y=>y&&y.includes(t));m.debug("filteredLog:",l),m.assertArgument(E.length!==0,"simulate log not match keyword","keyword",t),l.push(...E)}}return l}function Ar(e,r){let t=e.match(/{["\w:,]+}/g);return!t||t.length!==1?m.throwArgumentError("simulate log fail to match json","keyword",r):t[0]}function Or(e,r){let n=new RegExp(`"${r}":(\\d+)`,"g").exec(e);return!n||n.length!==2?m.throwArgumentError("simulate log fail to match key","key",r):n[1]}0&&(module.exports={ASSOCIATED_TOKEN_PROGRAM_ID,AccountMeta,AccountMetaReadonly,ErrorCode,LogLevel,Logger,MEMO_PROGRAM_ID,SYSTEM_PROGRAM_ID,SYSVAR_CLOCK_PUBKEY,SYSVAR_RENT_PUBKEY,TOKEN_PROGRAM_ID,chunkArray,findProgramAddress,forecastTransactionSize,getMultipleAccountsInfo,getMultipleAccountsInfoWithCustomFlags,inspectAll,inspectBN,inspectPublicKey,intersection,jsonInfo2PoolKeys,parseSimulateLogToJson,parseSimulateValue,poolKeys2JsonInfo,simulateMultipleInstruction,uniq,validateAndParsePublicKey,xor});
//# sourceMappingURL=index.js.map